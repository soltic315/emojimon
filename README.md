# EMOJIMON 🧸⚡ — ブラウザで遊べるポケモン風 RPG

> **🤖 このプロジェクトのコードは、人間が一切書いていません。**  
> すべてのソースコード・設計・ドキュメントは **AI（GitHub Copilot）によって生成** されています。  
> これは「AIがどこまでゲームを作れるか」という可能性を検証するための実験プロジェクトです。

Phaser 3 で実装した、絵文字モンスターたちが戦う **ポケモン風ターン制バトル RPG** です。  
`index.html` をブラウザで開くだけで遊べます。ビルド不要。

---

## 特長

- **6 つのエリア**を探索（エモじタウン / おうち / エモの森 / きらめき洞窟 / マグマ峠 / そらの遺跡）
- 草むら・森・洞窟・火山・遺跡での **ランダムエンカウント**（28種のモンスター）
- タイプ相性（炎/水/草/ノーマル）を活かした **1vs1 ターン制バトル**
- **特性システム**（えんしん / りゅうすい / しげみ / いわかべ）
- **42 種類の技**（攻撃技・変化技・先制技）
- **攻撃アニメーション**・パーティクル・ダメージ数字・画面シェイク
- **戦闘品質強化**（急所判定・相手AIの有利技優先・戦闘不能時の自動交代）
- **野生連勝システム**（連勝で報酬アップ、連戦ほど手強い相手が出現）
- **レア遭遇演出**（低確率でキラめく個体が出現し、捕獲率・報酬に補正）
- **遭遇テンポ改善**（一定歩数で遭遇率が上がるピティ補正でハマり軽減）
- **状態異常**（やけど：毎ターンダメージ＋物理わざの威力低下）
- **進化システム**（3 つの進化チェーン）
- **レベルアップ技習得**（成長に応じて新しい技を順次習得）
- **ジムバトル**（ボス戦）
- **セーブ/ロード**（LocalStorage）+ マップ遷移・バトル後のオートセーブ
- **ショップ**で 13 種類のアイテムを購入（回復・強化・捕獲ボール拡張）
- **Web Audio API** による手続き的 BGM・SE
- **サウンド設定**（タイトル画面でミュート/BGM音量/SE音量を調整・保存）
- **バトルテンポ設定**（メニュー→設定でバトル速度変更 / メッセージ自動送り / エンカウント演出短縮）
- **モバイル対応** — タッチ操作（仮想D-pad + A/Bボタン）・フルスクリーン
- **ゲーム内メニュー**（X/ESCキー）— パーティ管理・バッグ・図鑑・トレーナー情報・ガイド・設定
- **日替わりチャレンジ** — 毎日変わる目標（バトル/捕獲/闘技場）を達成して追加報酬を獲得
- **長編ストーリー進行** — マップごとの試験トレーナー戦と進行条件（捕獲数/戦闘数/平均Lv）で、クリア想定プレイ時間を約10時間に拡張
- **モンスター合成** — パーティ画面で2体を合成し、1体を素材にしてもう1体を強化（特定ペアはレシピ合成で別モンスターに変化）
- **絵文字レシピ合成** — 合成時にレシピ発見を記録。パーティ画面に「えもじレシピ」プレビューを表示
- **探索タイプアクション** — FIREで氷ブロック破壊 / WATERで特定水面を横断 / ELECTRICで暗闇の隠しアイテム可視化
- **エレメント連鎖** — 水/雨のあとに雷で感電追加ダメージ、こおり状態へ炎で蒸気爆発＋命中ダウン
- **ガイド機能** — 操作方法・探索/遭遇・天候/状態異常・タイプ相性・捕獲/逃走・成長要素を4ページで確認可能
- **ミニマップ** — フィールド右上にリアルタイムマップ表示
- **環境別バトル背景** — マップに応じた動的背景（町・森・洞窟）
- **タイプバッジ表示** — バトル中にモンスターのタイプをカラー表示
- **経験値共有** — バトル勝利時、パーティ全員に経験値を分配
- **エンカウント演出強化** — 3連フラッシュ + フェード
- **高品質フィールド描画** — タイルの複数バリアント自動分散で繰り返し感を低減
- **環境ライティング** — フィールドにアンビエント光と周辺ビネットを重ねた奥行き演出
- **プレミアムHUD** — 上部情報バー/通知パネル/ミニマップのガラス調UIに刷新
- **バトル背景リッチ化** — エリア別に多層背景/空気遠近/色調を強化
- **バトルコマンドUI刷新** — 行カードにアイコン・アクセント・選択グロウを追加
- **バトルHUD強化** — 情報パネルと戦闘ログ領域を高密度デザインへ統一
- **起動時データ検証** — `zod` による JSON スキーマ検証でデータ破損を早期検知
- NPC 会話・回復・クエスト
- すべてのグラフィックを Phaser Graphics で手続き生成（外部画像不要）

---

## 遊び方

### 起動

```bash
npm install
npm run dev
```

ブラウザで表示されたローカルURLにアクセス（通常は `http://localhost:5173`）。

### 品質チェック / ビルド

```bash
npm run lint
npm run typecheck
npm run test
npm run build
npm run preview
```

### 操作

| キー | フィールド | バトル |
|------|-----------|--------|
| ←↑→↓ / WASD | 移動 | メニュー選択（↑↓ / WS） |
| Z / Space | NPC会話・決定 | 決定・メッセージ送り |
| X / ESC | メニューを開く | キャンセル（戻る） |
| P | セーブ | — |

**モバイル操作**: タッチデバイスでは画面に仮想D-padとA/Bボタンが表示されます。  
右上のフルスクリーンボタン（🔳）で全画面表示が可能です。

タイトル画面の「サウンド設定」では、`←→` で音量調整、`Z` で切替、`X` で戻る操作ができます。

ゲーム内メニューの「設定」では、`←→` または `Z` でバトル速度・メッセージ自動送り・エンカウント演出短縮を切り替えられます。

パーティ画面では、`Z` で並び替え、`C` で合成（ベース選択→素材選択）が可能です。

レシピ合成の例:
- `ブレイズバード + スターライト → オーロロ`
- `パイロベア + ブレイズバード → オーロロ（隠し）`
- `ドロプレット + ブリザキャット → グラシエラ`
- `シンダーカブ + フィンバブ → ミストレイ`
- `クリスタリン + ソーンバイン → ブランブルオン`
- `シャドウポウ + スカイピップ → ルーンフォックス`

### ゲームの流れ

1. **タイトル画面**: 「はじめから」でニューゲーム（ゲーム内キーボードで名前入力）、「つづきから」でセーブデータ読込。
2. **エモじタウン**: ショップで装備を整え、草むらでモンスターを捕まえよう。
3. **エモの森**: 東の出口から森へ。レアモンスターやジムが待っている。
4. **きらめき洞窟**: 森の北側から入れる高難易度エリア。高レベル野生モンスターが出現。
5. **マグマ峠**: 洞窟奥の中上級者向けエリア。強力な炎系・混成パーティが出現。
6. **そらの遺跡**: 最深部エリア。高レベル個体と希少種を狙える。
7. **試験トレーナー**: 森/洞窟/ダークタワー/火山/氷峰/遺跡に追加された試験戦を突破し、進行資格を解放。
8. **進行条件達成**: 捕獲数・戦闘数・闘技場3連戦・パーティ平均Lvの条件を満たして次エリアへ進む。
9. **ジム・ボス決戦**: 氷峰ジム、遺跡の守人試練、最終決戦の順でクリアを目指す。
10. **育成と周回**: バトル勝利で経験値 → レベルアップ → 進化チェーン拡張！
11. **日替わり目標**: トレーナー情報で本日のチャレンジ進捗を確認し、達成報酬を狙おう。

---

## モンスター（28体）

| 絵文字 | 名前 | タイプ | 進化 |
|--------|------|--------|------|
| 🧸 | エムベア | FIRE | → パイアベア (Lv12) |
| 🔥 | パイアベア | FIRE | — |
| 💧 | ドロプレット | WATER | → タイダロン (Lv14) |
| 🌊 | タイダロン | WATER | — |
| 🌿 | リーフリング | GRASS | → ソーンキング (Lv13) |
| 🌳 | ソーンキング | GRASS | — |
| ⭐ | スターライト | NORMAL | — |
| 🐦 | ブレイズバード | FIRE | — |
| 🐢 | アクアシェル | WATER | — |
| 🌵 | ソーンバイン | GRASS | — |
| 🐾 | シャドウポー | NORMAL | — |
| 💎 | クリスタライン | NORMAL | — |
| 🌋 | マグモグ | FIRE | — |
| 🦭 | リップリンクス | WATER | — |
| 🍀 | ブランブルオン | GRASS | — |
| 🌙 | ムーンマイト | NORMAL | — |
| 🦊 | シンダーカブ | FIRE | → ヴォルカノックス (Lv16) |
| 🗻 | ヴォルカノックス | FIRE | — |
| 🐺 | アッシュハウンド | FIRE | — |
| 🐟 | フィンバブ | WATER | → グラシエラ (Lv17) |
| 🧊 | グラシエラ | WATER | — |
| 🐬 | ミストレイ | WATER | — |
| 🌱 | スプラウトル | GRASS | → ブルームラ (Lv16) |
| 🌺 | ブルームラ | GRASS | — |
| 🫎 | モスホーン | GRASS | — |
| 🕊️ | スカイピップ | NORMAL | → オーロロ (Lv18) |
| 🪽 | オーロロ | NORMAL | — |
| 🦝 | ルーンフォックス | NORMAL | — |

---

## 技術スタック

- **Phaser 3** v3.80.0（CDN）
- **TypeScript** ES Modules
- **Vite**（開発サーバー / 本番ビルド）
- **TypeScript**（既存コードを `.ts` へ移行済み、型付けは段階的に強化）
- **ESLint**（静的解析）
- **Vitest**（ユニットテスト）
- **GSAP** — バトル演出とUI遷移のモーション強化
- **phaser3-rex-plugins (rexUI)** — タイトルUIカードなどのリッチUI構築
- **Web Audio API** — 手続き的サウンド生成
- **LocalStorage** — セーブデータ
- **ゲームデータ JSON** — `assets/data/monsters.json` / `assets/data/moves.json` / `assets/data/items.json` / `assets/data/abilities.json`
- **Zod** — 起動時のランタイムスキーマ検証（データ整合性の担保）

### AI開発向けのコード構成メモ

- マップ依存ロジック（遭遇モンスター選択 / 天候ロール / バトル背景テーマ）は `js/data/mapRules.ts` に集約。
- `WorldScene` と `BattleScene` は `mapRules` を参照する構造のため、マップ仕様の変更時はまず `mapRules` を編集。
- `WorldScene` の巨大定義は分割済みで、マップ/NPC/ドア遷移は `js/scenes/world/worldMapData.ts`、ショップUI/入力は `js/scenes/world/worldShop.ts` を編集。
- `BattleScene` の定数/表示ヘルパーは `js/scenes/battle/battleConstants.ts`、コマンドメニューUIは `js/scenes/battle/battleMenu.ts` に分割済み。
- `MenuScene` の定数/ガイド文言は `js/scenes/menu/menuConstants.ts`、各サブ画面描画は `js/scenes/menu/menuViews.ts` に分割済み。
- シーン固有の見た目や演出のみを変更したい場合は、各 Scene 側を編集（ルール自体は `mapRules` を優先）。

詳しい設計は [GAME_DESIGN.md](GAME_DESIGN.md) を参照。

